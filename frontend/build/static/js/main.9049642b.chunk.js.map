{"version":3,"sources":["components/InteractiveRoom.jsx","App.js","index.js"],"names":["InteractiveRoom","props","connect","host_url","window","location","host","websocket_url","ws","WebSocket","onopen","console","log","setState","onclose","e","onmessage","data","JSON","parse","id","state","usersMap","x","y","delete","set","onerror","err","error","message","close","displayName","Map","this","uuidv4","mouseX","clientX","mouseY","clientY","readyState","json_data","stringify","send","to","className","onMouseMove","_onMouseMove","bind","style","height","width","padding","margin","Math","random","UserList","React","Component","size","Array","from","values","map","user","position","top","left","fontSize","color","name","JoinSession","useState","inputVal","setInputVal","value","onChange","event","target","type","placeholder","autoFocus","pathname","outline","textDecoration","border","borderRadius","App","exact","path","component","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.9049642b.chunk.js","sourcesContent":["import React, { useState } from 'react';\nimport {Redirect} from \"react-router-dom\";\nimport { v4 as uuidv4 } from 'uuid';\n\nexport default class InteractiveRoom extends React.Component {\n\n    constructor(props){\n      super(props);\n      this.state = {\n        id: '',\n        displayName: props.location.displayName,\n        ws: null,\n        x: 0, \n        y: 0,\n        usersMap: new Map(),\n      }\n    }\n  \n    // const [usersMap, setUsersMap] = useState(new Map());\n\n    componentDidMount(){\n      this.setState({id: uuidv4(), displayName: this.state.displayName})\n      this.connect();\n    }\n  \n    componentWillUnmount(){\n      this.setState({\"displayName\": null})\n      if (this.state.ws != null) {\n        this.state.ws.close();\n      }\n    }\n  \n    connect = () => {\n      const host_url = window.location.host\n      const websocket_url = `ws://${host_url}/chat`\n      const ws = new WebSocket(websocket_url);\n        // websocket onopen event listener\n        ws.onopen = () => {\n          console.log(`websocket connected at ${websocket_url}`);\n          this.setState({ ws: ws });\n      };\n\n        // websocket onclose event listener\n        ws.onclose = e => {\n          console.log(\"Socket is closed\")\n        };\n\n        ws.onmessage = e => {\n          \n          // oncoming\n          let data = JSON.parse(e.data)\n\n          if (data.id != null && data.id !== this.state.id) {\n            let usersMap = this.state.usersMap\n          \n            if (data.x === -1 && data.y === -1){\n              // leave the room\n              usersMap.delete(data.id)\n            } else {\n              usersMap.set(data.id, data)\n            }\n\n            this.setState(usersMap)\n\n          } // else dont do anything\n        }\n\n        // websocket onerror event listener\n        ws.onerror = err => {\n          console.error(\n              \"Socket encountered error: \",\n              err.message,\n              \"Closing socket\"\n          );\n\n          ws.close();\n      };\n    }\n\n    _onMouseMove(e) {\n      let mouseX = e.clientX\n      let mouseY = e.clientY\n      this.setState({x: mouseX, y: mouseY });\n\n      const ws = this.state.ws\n      if (ws != null && ws.readyState === 1) {\n        let data = {id: this.state.id, x: mouseX, y: mouseY, displayName: this.state.displayName}\n        let json_data = JSON.stringify(data)\n        this.state.ws.send(json_data)\n      }\n    }\n\n    render() {\n  \n      let displayName = this.state.displayName\n\n      if (displayName == null || displayName === '') {\n        return <Redirect to={'/'} />\n      }\n\n      const style = {\n        height: \"100vh\",\n        width: \"100%\",\n        padding: \"0\",\n        margin: \"0\"\n      }\n\n      const { x, y, usersMap } = this.state;\n\n      return (\n        <div className=\"interactiveRoom\" onMouseMove={this._onMouseMove.bind(this)} style={style} >\n          {Math.random()} {displayName} { x } { y }\n\n          <UserList usersMap={usersMap}/>\n        </div>\n      );\n    }\n  }\n\n\nfunction UserList({usersMap}) {\n\n    if (usersMap.size === 0) {\n      return <div></div>\n    }\n\n    let users = Array.from(usersMap.values())\n\n    return users.map((user) => {\n        const style = {\n            position: \"absolute\",\n            top: `${user.y}px`,\n            left: `${user.x}px`,\n            fontSize: \"30px\",\n            color: \"red\"\n        }\n        return <div key={user.id} style={style}>{user.name}</div>\n    })\n}","import './App.css';\nimport React, { useState } from 'react';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link,\n} from \"react-router-dom\";\nimport InteractiveRoom from './components/InteractiveRoom.jsx'\n\nfunction App() {\n  return (\n    <Router>\n      <div>\n        {/*\n          A <Switch> looks through all its children <Route>\n          elements and renders the first one whose path\n          matches the current URL. Use a <Switch> any time\n          you have multiple routes, but you want only one\n          of them to render at a time\n        */}\n        <Switch>\n\n          <Route exact path=\"/\">\n            <JoinSession />\n          </Route>\n\n          <Route exact path=\"/chatroom\" component={InteractiveRoom} />\n        </Switch>\n      </div>\n    </Router>\n  );\n}\n\nfunction JoinSession() {\n\n\tconst buttonStyle = {\n\t\toutline:\"none\",\n    color: \"white\",\n    textDecoration: \"none\",\n    border: \"solid\",\n    padding: \"5px\",\n    borderRadius: \"10px\"\n\t}\n\n  const [inputVal, setInputVal] = useState('');\n\n  return (\n    <div className=\"App\">\n\n\t\t\t<div className=\"joinSession\">\n        <input\n          value={inputVal} \n          onChange={event => setInputVal(event.target.value)}\n          type=\"text\" placeholder=\"Name\" autoFocus\n        />\n\n        <br/> <br/>\n        <Link \n        to={{\n          pathname:'/chatroom',\n          displayName: inputVal, \n        }} \n        style={buttonStyle}>\n          Join Session\n        </Link>\n\t\t\t</div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}